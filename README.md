# 콕스웨이브 과제: RAG 기반 스마트스토어 FAQ 챗봇

## 개요

**스마트스토어 FAQ 챗봇**은 스마트스토어 플랫폼에 대한 사용자 질문에 대해 정확하고 효율적인 답변을 제공합니다. RAG (Retrieval-Augmented Generation), BM25, LLM 등을 활용하여 높은 품질의 응답을 보장하며, 비용과 성능을 최적화합니다.

---

## 아키텍처

### 1. UI 영역
- **기능**: 사용자가 질문을 입력하고 답변을 확인하는 인터페이스 제공.
- **구성 요소**:
  - **질문 입력**: 사용자가 질문을 입력할 수 있는 텍스트 필드.
  - **응답 표시**: 챗봇의 답변을 출력하는 영역.

### 2. API 서버 영역
- **기능**: UI와 도메인 계층 간의 통신을 관리하며 RESTful API를 제공합니다.
- **구성 요소**:
  - **Routes**: RESTful API 엔드포인트 정의.
  - **Controllers**: 라우트에서 호출되는 함수, LLM 호출 포함.

### 3. 도메인 (LLMChain) 영역
- **기능**: 데이터 전처리, 검색, 그리고 응답 생성까지의 핵심 로직을 담당.
- **구성 요소**:
  1. **Preprocess 모듈**:
     - 데이터를 로드하고 효율적으로 저장 및 검색할 수 있도록 분리.
     - 중복 제거 및 불필요한 텍스트 삭제.
  2. **Vector Store 및 Retrieval 모듈**:
     - 전처리된 데이터를 저장.
     - RAG와 BM25를 기반으로 질문에 적합한 데이터를 검색.
     - 스마트스토어와 관련 없는 질문에는 아래와 같은 기본 응답 제공:
       ```
       저는 스마트 스토어 FAQ를 위한 챗봇입니다. 스마트 스토어에 대한 질문을 부탁드립니다.
       ```
  3. **LLMGenerator 모듈**:
     - 제공된 FAQ 데이터(`final_result.pkl`)를 기반으로 고품질 답변 생성.
     - 대화 기록을 저장하여 맥락 기반 답변 제공.
     - 질문-답변 맥락에서 사용자가 궁금해할만한 추가 질문을 제안.

---

## 주요 기능

1. **응답 품질**:
   - 스마트스토어 FAQ 데이터를 기반으로 정확한 답변 생성.
   - 관련 없는 질문에는 미리 정의된 메시지를 응답.

2. **대화 맥락**:
   - 대화 기록을 저장하여 사용자의 의도를 파악하고 맥락에 맞는 답변 제공.

3. **성능 최적화**:
   - **스트리밍**: 부분 응답을 먼저 전달하여 응답 지연 최소화.
   - **비용 절감**:
     - BM25 및 해시 기반 검색을 통해 LLM 호출 최소화.
     - 미리 정의된 응답은 LLM 호출 없이 처리.
   - **프롬프트 최적화**:
     - 정확하고 간결한 프롬프트 설계를 통해 LLM 성능 향상 및 토큰 사용 감소.

---

## 개선 방안

### 1. **응답 품질 및 챗봇 성능**
- **응답 시간**:
  - 스트리밍을 통해 LLM 응답 지연을 줄임.
- **비용 효율성**:
  - 간단한 질문은 BM25, 해시 테이블 등 결정적 방법으로 처리.
  - 복잡한 다중 컨텍스트 질문에만 LLM 호출.
- **맥락 이해**:
  - 대화 히스토리 저장 메커니즘 개선.
  - 다양한 프롬프트 템플릿 실험을 통해 문맥 이해도 향상.
- **응답 정확성**:
  - 숫자 및 사실 확인을 포함한 응답 품질 강화.

### 2. **전처리 개선**
- 중복 제거 및 불필요한 텍스트 삭제.
- 키워드 추출을 통해 BM25 검색 효율 향상.

### 3. **프롬프트 연구**
- 챗봇의 성능 향상을 위한 프롬프트 템플릿 설계 실험.
